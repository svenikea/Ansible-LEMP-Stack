# vm.yaml
---
  - hosts: server1
    become: yes
    vars: 
      UserList: "{{ lookup('file', './roles/webserver/vars/information.json') }}"
    tasks:
      - name: Creating User
        user:
          name: "{{ item.name }}"
          home: "{{ item.home }}"
          append: "{{ item.append }}"
          group: "{{ item.group }}"
          shell: "{{ item.shell }}"
          password: "{{ item.password | password_hash('sha512') }}"
          state: present
        loop: "{{ UserList.users }}"
        tags: working
      - name: Adding User Pub Key
        authorized_key:
          user: "{{ item.name }}"
          state: present
          key: "{{ item.pubkey }}"
          validate_certs: false
          manage_dir: yes
        
        loop: "{{ UserList.users }}"
        tags: adding key

      


